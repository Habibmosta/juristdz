// Test du nettoyage radical avec le contenu utilisateur rÃ©el
console.log('ğŸš¨ Test du nettoyage RADICAL');

// Contenu exact fourni par l'utilisateur
const userContent = `Ù…Ø­Ø§Ù…ÙŠ Ø¯ÙŠ Ø²Ø§Ø¯Ù…ØªØµÙ„Ù…Ø­Ø§Ù…ÙŠÙ…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠØªØ­Ø±ÙŠØ±ProØªØ­Ù„ÙŠÙ„Ù…Ù„ÙØ§ØªV2ÙˆØ«Ø§Ø¦Ù‚Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©+ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯+ Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹arÙˆØ¶Ø¹ Ø¢Ù…Ù†Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©. ØªØ­Ù‚Ù‚ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¬Ø±ÙŠØ¯Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©.Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠØ®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠğŸ”„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†ğŸ§¹ØªÙ†Ø¸ÙŠÙØªØ±Ø¬Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ù†Ø³Ø® Ø±Ø§Ø¨Ø·Ø£Ù†ØªÙ…ØªØ±Ø¬Ù…la Ø§Ù„Ø£Ø³Ø±Ø©JuristDZÙ…ØªØ±Ø¬Ù…La Ø§Ù„Ø£Ø³Ø±Ø© est un domaine juridique important en Algrie. Voici quelques informations cls : Marriage Le Ø§Ù„Ø²ÙˆØ§Ø¬ est reconnu par larticle 1 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©, qui stipule que le Ø§Ù„Ø²ÙˆØ§Ø¬ est un contrat par lequel deux personnes, capables de contracter, sengagent vivre ensemble en Ø§Ù„Ø²ÙˆØ§Ø¬. Le Ø§Ù„Ø²ÙˆØ§Ø¬ est considr comme un contrat civil, et ses effets sont rgis par le Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø© (articles 2 15). Les poux ont les mmes Ø§Ù„Ø­Ù‚ÙˆÙ‚ et devoirs (Ø§Ù„Ù…Ø§Ø¯Ø© 12 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). Le Ø§Ù„Ø·Ù„Ø§Ù‚ Le Ø§Ù„Ø·Ù„Ø§Ù‚ est autoris par larticle 16 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©, qui stipule que le Ø§Ù„Ø·Ù„Ø§Ù‚ peut tre prononc pour faute ou pour incompatibilit de caractre. Les poux peuvent demander le Ø§Ù„Ø·Ù„Ø§Ù‚ en justice (Ø§Ù„Ù…Ø§Ø¯Ø© 17 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). Le Ø§Ù„Ø·Ù„Ø§Ù‚ est prononc par le tribunal de premire instance (Ø§Ù„Ù…Ø§Ø¯Ø© 18 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). Lenfant est protg par larticle 19 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©, qui stipule que lenfant a Ø§Ù„Ø­Ù‚ la Ø§Ù„Ø­Ù…Ø§ÙŠØ© de ses Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ† et de la socit. Les Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ† ont lobligation de fournir leur Ø§Ù„Ø·ÙÙ„ une ducation et une formation appropries (Ø§Ù„Ù…Ø§Ø¯Ø© 20 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). Lenfant a le Ø§Ù„Ø­Ù‚ de bnficier de la Ø§Ù„Ø­Ø¶Ø§Ù†Ø© de ses Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ† (Ø§Ù„Ù…Ø§Ø¯Ø© 21 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). La Ø§Ù„Ù†Ø³Ø¨ La Ø§Ù„Ù†Ø³Ø¨ est rgie par larticle 22 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©, qui stipule que la Ø§Ù„Ù†Ø³Ø¨ est tablie par la naissance ou par ladoption. La Ø§Ù„Ù†Ø³Ø¨ peut tre tablie par le pre ou la mre (Ø§Ù„Ù…Ø§Ø¯Ø© 23 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). La Ø§Ù„Ù†Ø³Ø¨ peut tre conteste en justice (Ø§Ù„Ù…Ø§Ø¯Ø© 24 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). La Ø§Ù„ÙˆØµØ§ÙŠØ© La Ø§Ù„ÙˆØµØ§ÙŠØ© est rgie par larticle 25 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©, qui stipule que la Ø§Ù„ÙˆØµØ§ÙŠØ© est institue pour veiller au bien-tre de lenfant. La Ø§Ù„ÙˆØµØ§ÙŠØ© peut tre confie un Ø§Ù„ÙˆØ§Ù„Ø¯ ou un tiers (Ø§Ù„Ù…Ø§Ø¯Ø© 26 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). La Ø§Ù„ÙˆØµØ§ÙŠØ© peut tre conteste en justice (Ø§Ù„Ù…Ø§Ø¯Ø© 27 du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø©). Ces informations sont extraites du Ù‚Ø§Ù†ÙˆÙ† de la Ø§Ù„Ø£Ø³Ø±Ø© algrien. Si vous avez besoin de plus de dtails ou de prcisions, nhsitez pas me le demander.Ø¥Ø±Ø³Ø§Ù„`;

// Fonction de nettoyage radical (copiÃ©e de ImprovedChatInterface.tsx)
function cleanUIContent(text) {
    if (!text || typeof text !== 'string') return text;
    
    console.log(`ğŸ§¹ NETTOYAGE RADICAL - DÃ©but: "${text.substring(0, 100)}..."`);
    
    // Ã‰TAPE 0: Si le texte contient trop d'Ã©lÃ©ments UI, le rejeter complÃ¨tement
    const uiIndicators = [
      'Ù…Ø­Ø§Ù…ÙŠ Ø¯ÙŠ Ø²Ø§Ø¯', 'Ù…ØªØµÙ„Ù…Ø­Ø§Ù…ÙŠ', 'Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©', 'Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©',
      'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠ', 'ØªØ­Ø±ÙŠØ±Pro', 'ØªØ­Ù„ÙŠÙ„Ù…Ù„ÙØ§Øª', 'Ù…Ù„ÙØ§ØªV2',
      'ÙˆØ«Ø§Ø¦Ù‚Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©', '+ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯', '+ Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹', 'arÙˆØ¶Ø¹ Ø¢Ù…Ù†',
      'Ø®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ', 'ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„', 'Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„', 'Ù†Ø³Ø® Ø±Ø§Ø¨Ø·',
      'Ø£Ù†ØªÙ…ØªØ±Ø¬Ù…', 'JuristDZ', 'ğŸ”„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†', 'ğŸ§¹ØªÙ†Ø¸ÙŠÙ', 'Ø¥Ø±Ø³Ø§Ù„'
    ];
    
    let uiCount = 0;
    uiIndicators.forEach(indicator => {
      if (text.includes(indicator)) {
        uiCount++;
      }
    });
    
    // Si plus de 3 indicateurs UI, rejeter complÃ¨tement le texte
    if (uiCount > 3) {
      console.log(`ğŸ§¹ REJET COMPLET - Trop d'Ã©lÃ©ments UI dÃ©tectÃ©s: ${uiCount}`);
      return '';
    }
    
    let cleaned = text;
    
    // Ã‰TAPE 1: Supprimer TOUS les patterns exacts du nouveau rapport utilisateur
    const exactUIPatterns = [
      // NOUVEAU: Patterns du dernier rapport utilisateur
      'Ù…Ø­Ø§Ù…ÙŠ Ø¯ÙŠ Ø²Ø§Ø¯Ù…ØªØµÙ„Ù…Ø­Ø§Ù…ÙŠÙ…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠØªØ­Ø±ÙŠØ±ProØªØ­Ù„ÙŠÙ„Ù…Ù„ÙØ§ØªV2ÙˆØ«Ø§Ø¦Ù‚Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©+ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯+ Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹arÙˆØ¶Ø¹ Ø¢Ù…Ù†Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©. ØªØ­Ù‚Ù‚ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¬Ø±ÙŠØ¯Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©.Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠØ®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠğŸ”„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†ğŸ§¹ØªÙ†Ø¸ÙŠÙØªØ±Ø¬Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ù†Ø³Ø® Ø±Ø§Ø¨Ø·Ø£Ù†ØªÙ…ØªØ±Ø¬Ù…',
      
      // Patterns individuels
      'Ù…Ø­Ø§Ù…ÙŠ Ø¯ÙŠ Ø²Ø§Ø¯Ù…ØªØµÙ„Ù…Ø­Ø§Ù…ÙŠÙ…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©',
      'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠØªØ­Ø±ÙŠØ±ProØªØ­Ù„ÙŠÙ„Ù…Ù„ÙØ§ØªV2ÙˆØ«Ø§Ø¦Ù‚',
      'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©+ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯+ Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹arÙˆØ¶Ø¹ Ø¢Ù…Ù†',
      'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©. ØªØ­Ù‚Ù‚ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¬Ø±ÙŠØ¯Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©.',
      'Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠØ®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠğŸ”„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†ğŸ§¹ØªÙ†Ø¸ÙŠÙ',
      'ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ù†Ø³Ø® Ø±Ø§Ø¨Ø·Ø£Ù†ØªÙ…ØªØ±Ø¬Ù…',
      
      // Ã‰lÃ©ments individuels
      'Ù…Ø­Ø§Ù…ÙŠ Ø¯ÙŠ Ø²Ø§Ø¯', 'Ù…ØªØµÙ„Ù…Ø­Ø§Ù…ÙŠ', 'Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©', 'Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©',
      'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠ', 'ØªØ­Ø±ÙŠØ±Pro', 'ØªØ­Ù„ÙŠÙ„Ù…Ù„ÙØ§Øª', 'Ù…Ù„ÙØ§ØªV2',
      'ÙˆØ«Ø§Ø¦Ù‚Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©', '+ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯', '+ Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹', 'arÙˆØ¶Ø¹ Ø¢Ù…Ù†',
      'Ø®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ', 'ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„', 'Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„', 'Ù†Ø³Ø® Ø±Ø§Ø¨Ø·',
      'Ø£Ù†ØªÙ…ØªØ±Ø¬Ù…', 'ğŸ”„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†', 'ğŸ§¹ØªÙ†Ø¸ÙŠÙ',
      
      // Artifacts techniques
      'JuristDZ', 'AUTO-TRANSLATE', 'Defined', 'Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´Ø©', 'Ø¥Ø±Ø³Ø§Ù„',
      
      // NOUVEAU: Patterns de mÃ©lange spÃ©cifiques du rapport
      'la Ø§Ù„Ø£Ø³Ø±Ø©', 'La Ø§Ù„Ø£Ø³Ø±Ø©', 'Le Ø§Ù„Ø²ÙˆØ§Ø¬', 'le Ø§Ù„Ø²ÙˆØ§Ø¬', 'Le Ø§Ù„Ø·Ù„Ø§Ù‚', 'le Ø§Ù„Ø·Ù„Ø§Ù‚',
      'du Ù‚Ø§Ù†ÙˆÙ†', 'de la Ø§Ù„Ø£Ø³Ø±Ø©', 'Ø§Ù„Ù…Ø§Ø¯Ø©', 'les Ø§Ù„Ø­Ù‚ÙˆÙ‚', 'Ø§Ù„Ø­Ù…Ø§ÙŠØ©', 'ses Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†',
      'leur Ø§Ù„Ø·ÙÙ„', 'le Ø§Ù„Ø­Ù‚', 'la Ø§Ù„Ø­Ø¶Ø§Ù†Ø©', 'La Ø§Ù„Ù†Ø³Ø¨', 'la Ø§Ù„Ù†Ø³Ø¨', 'La Ø§Ù„ÙˆØµØ§ÙŠØ©',
      'la Ø§Ù„ÙˆØµØ§ÙŠØ©', 'un Ø§Ù„ÙˆØ§Ù„Ø¯'
    ];
    
    // Supprimer tous les patterns exacts
    exactUIPatterns.forEach(pattern => {
      const escapedPattern = pattern.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      cleaned = cleaned.replace(new RegExp(escapedPattern, 'g'), '');
    });
    
    // Ã‰TAPE 2: Supprimer les mÃ©langes arabe-franÃ§ais spÃ©cifiques
    const mixedLanguagePatterns = [
      // Patterns franÃ§ais-arabe mÃ©langÃ©s
      /\b[A-Za-zÃ€-Ã¿]+\s+[\u0600-\u06FF]+/g, // Mot franÃ§ais suivi d'arabe
      /[\u0600-\u06FF]+\s+[A-Za-zÃ€-Ã¿]+/g, // Mot arabe suivi de franÃ§ais
      /\b[A-Za-zÃ€-Ã¿]+[\u0600-\u06FF]+/g, // FranÃ§ais collÃ© Ã  l'arabe
      /[\u0600-\u06FF]+[A-Za-zÃ€-Ã¿]+/g, // Arabe collÃ© au franÃ§ais
      
      // Patterns spÃ©cifiques problÃ©matiques
      /Pro(?=[\u0600-\u06FF])/g,
      /V2(?=[\u0600-\u06FF])/g,
      /ar(?=[\u0600-\u06FF])/g,
      
      // Ã‰mojis et caractÃ¨res spÃ©ciaux
      /ğŸ”„|ğŸ§¹|ğŸ“‹|âš–ï¸|ğŸ›ï¸|ğŸ“Š|ğŸ“ˆ|ğŸ’¼|ğŸ”|ğŸ“|ğŸ“„|ğŸ“‹|âœ…|âŒ|â­|ğŸŒŸ/g,
      
      // Suppression des doublons de mots
      /(\b\w+\b)(\s+\1\b)+/g,
      
      // Nettoyage des espaces et caractÃ¨res
      /\s{2,}/g, // Espaces multiples
      /[\r\n\t]+/g, // Sauts de ligne et tabulations
    ];
    
    mixedLanguagePatterns.forEach(pattern => {
      if (pattern.toString().includes('(\\b\\w+\\b)')) {
        // Pattern spÃ©cial pour les doublons
        cleaned = cleaned.replace(pattern, '$1');
      } else if (pattern.toString().includes('\\s{2,}')) {
        // Pattern pour les espaces multiples
        cleaned = cleaned.replace(pattern, ' ');
      } else {
        // Autres patterns
        cleaned = cleaned.replace(pattern, '');
      }
    });
    
    // Ã‰TAPE 3: VÃ©rification de puretÃ© linguistique ULTRA STRICTE
    cleaned = cleaned.trim();
    
    if (cleaned.length === 0) {
      console.log(`ğŸ§¹ REJET - Texte complÃ¨tement nettoyÃ©`);
      return '';
    }
    
    const arabicChars = (cleaned.match(/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF]/g) || []).length;
    const latinChars = (cleaned.match(/[a-zA-ZÃ€-Ã¿]/g) || []).length;
    const totalChars = cleaned.replace(/\s/g, '').length;
    
    if (totalChars > 0) {
      const arabicRatio = arabicChars / totalChars;
      const latinRatio = latinChars / totalChars;
      
      console.log(`ğŸ§¹ Analyse linguistique: Arabic ${Math.round(arabicRatio * 100)}%, Latin ${Math.round(latinRatio * 100)}%`);
      
      // ULTRA STRICT: Si plus de 5% de mÃ©lange, rejeter
      if (arabicRatio > 0.05 && latinRatio > 0.05) {
        console.log(`ğŸ§¹ REJET - MÃ©lange linguistique dÃ©tectÃ©`);
        return '';
      }
      
      // Si moins de 20 caractÃ¨res utiles, rejeter
      if (totalChars < 20) {
        console.log(`ğŸ§¹ REJET - Texte trop court: ${totalChars} caractÃ¨res`);
        return '';
      }
    }
    
    console.log(`ğŸ§¹ SUCCÃˆS - Nettoyage terminÃ©: "${cleaned.substring(0, 50)}..."`);
    return cleaned;
}

console.log('ğŸš¨ Contenu original (longueur):', userContent.length);
console.log('ğŸš¨ Contenu original (aperÃ§u):', userContent.substring(0, 200) + '...');

const cleanedContent = cleanUIContent(userContent);

console.log('ğŸš¨ Contenu aprÃ¨s nettoyage radical (longueur):', cleanedContent.length);
if (cleanedContent.length > 0) {
  console.log('ğŸš¨ Contenu aprÃ¨s nettoyage radical (aperÃ§u):', cleanedContent.substring(0, 200) + '...');
} else {
  console.log('ğŸš¨ âœ… SUCCÃˆS: Contenu complÃ¨tement rejetÃ© - trop contaminÃ©');
}

// Test de dÃ©tection d'indicateurs UI
const uiIndicators = [
  'Ù…Ø­Ø§Ù…ÙŠ Ø¯ÙŠ Ø²Ø§Ø¯', 'Ù…ØªØµÙ„Ù…Ø­Ø§Ù…ÙŠ', 'Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§Ù…Ø§Ø©', 'Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©',
  'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'Ø¨Ø­Ø« Ù‚Ø§Ù†ÙˆÙ†ÙŠ', 'ØªØ­Ø±ÙŠØ±Pro', 'ØªØ­Ù„ÙŠÙ„Ù…Ù„ÙØ§Øª', 'Ù…Ù„ÙØ§ØªV2',
  'ÙˆØ«Ø§Ø¦Ù‚Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©', '+ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯', '+ Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹', 'arÙˆØ¶Ø¹ Ø¢Ù…Ù†',
  'Ø®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ', 'ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„', 'Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„', 'Ù†Ø³Ø® Ø±Ø§Ø¨Ø·',
  'Ø£Ù†ØªÙ…ØªØ±Ø¬Ù…', 'JuristDZ', 'ğŸ”„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†', 'ğŸ§¹ØªÙ†Ø¸ÙŠÙ', 'Ø¥Ø±Ø³Ø§Ù„'
];

let uiCount = 0;
uiIndicators.forEach(indicator => {
  if (userContent.includes(indicator)) {
    uiCount++;
    console.log(`ğŸš¨ Indicateur UI dÃ©tectÃ©: "${indicator}"`);
  }
});

console.log(`ğŸš¨ Total d'indicateurs UI dÃ©tectÃ©s: ${uiCount}`);
console.log(`ğŸš¨ Seuil de rejet: 3 indicateurs`);
console.log(`ğŸš¨ RÃ©sultat: ${uiCount > 3 ? 'REJET COMPLET' : 'NETTOYAGE PARTIEL'}`);

console.log('ğŸš¨ âœ… Test du nettoyage radical terminÃ©');